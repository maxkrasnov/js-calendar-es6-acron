"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),JSCalendar=function(){function t(e,n){_classCallCheck(this,t),this.default={parent:"js-calendar",theme:"js-calendar-default",prev:"__prev",next:"__next",day:"__day",header:"__header",month:"__month",year:"__year",week:"__week",weekday:"__weekday",days:"__days",today:"_today"},this.setDate(n.initDate),this.props={inputId:!!n.inputId&&n.inputId,today:(new Date).getDate()+"."+(new Date).getMonth()+"."+(new Date).getFullYear(),buttons:n.buttons,parent:e||this.default.parent,theme:n.theme?n.theme:this.default.theme,prevButton:n.theme?n.theme+this.default.prev:this.default.theme+this.default.prev,nextButton:n.theme?n.theme+this.default.next:this.default.theme+this.default.next,prevButtonInnerHtml:n.prevButtonInnerHtml?n.prevButtonInnerHtml:"",nextButtonInnerHtml:n.nextButtonInnerHtml?n.nextButtonInnerHtml:"",onBeforeClickDay:n.onBeforeClickDay?n.onBeforeClickDay:null,onAfterClickDay:n.onAfterClickDay?n.onAfterClickDay:null,onAfterChangeMonth:n.onAfterChangeMonth?n.onAfterChangeMonth:null,onBeforeChangeMonth:n.onBeforeChangeMonth?n.onBeforeChangeMonth:null,fade:!!n.fade&&n.fade,weeks:["Пн","Вт","Ср","Чт","Пт","Сб","Вс"],months:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],timestamp:!!n.inputDateFormatTimestamp}}return _createClass(t,[{key:"init",value:function(){console.info("JS Calendar init [by maxkrasnov (me@maxkrasnov.ru)]"),this._generateHtml()}},{key:"setMonths",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];12==t.length?this.props.months=t:console.error("Months array length must = 12")}},{key:"setWeekdays",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];7==t.length?this.props.weeks=t:console.error("Weekdays array length must = 7")}},{key:"getCurrentMonthName",value:function(){return this.props.months[this.date.month]}},{key:"setDate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date,e=new Date(t.getFullYear(),t.getMonth(),1).getDay()-1;e=e<0?6:e,this.date={year:t.getFullYear(),month:t.getMonth(),day:t.getDate(),startDay:e,daysOfMonth:new Date(t.getFullYear(),t.getMonth()+1,0).getDate()}}},{key:"setNextMonth",value:function(){var t=this.getMonth("next"),e=t.month,n=t.year;this.setDate(new Date(n,e,1))}},{key:"setPrevMonth",value:function(){var t=this.getMonth("prev"),e=t.month,n=t.year;this.setDate(new Date(n,e,1))}},{key:"getMonth",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"next",e=this,n=e.date.month,a=e.date.year;return"next"==t?11==n?(n=0,a++):n++:0==n?(n=11,a--):n--,{month:n,year:a}}},{key:"initButtonEvents",value:function(){var t=this,e=document.getElementById(t.props.prevButton),n=document.getElementById(t.props.nextButton);e.addEventListener("click",function(e){if("function"==typeof t.props.onBeforeChangeMonth&&!1===t.props.onBeforeChangeMonth(this))return!1;t.setPrevMonth(),t._generateHtml(),"function"==typeof t.props.onAfterChangeMonth&&t.props.onAfterChangeMonth(this,e)}),n.addEventListener("click",function(e){if("function"==typeof t.props.onBeforeChangeMonth&&!1===t.props.onBeforeChangeMonth(this,e))return!1;t.setNextMonth(),t._generateHtml(),"function"==typeof t.props.onAfterChangeMonth&&t.props.onAfterChangeMonth(this,e)})}},{key:"initDayClickEvents",value:function(){for(var t=this,e=document.getElementsByClassName(""+(t.props.theme+t.default.day)),n=0;n<e.length;n++)e[n].addEventListener("click",function(e){if("function"==typeof t.props.onBeforeClickDay&&!1===t.props.onBeforeClickDay(this,e))return!1;for(var n=t.props.theme+t.default.day+"_selected",a=document.getElementsByClassName(n),o=0;o<a.length;o++)a[o].classList.remove(n);this.classList.add(n);var r=this.getAttribute("data-time");if(t.props.inputId){var s=document.getElementById(t.props.inputId);if(!t.props.timestamp){var i=(r=new Date(parseInt(r))).getDate(),l=r.getMonth()+1;r=(i=i<10?"0"+i:i)+"."+(l=l<10?"0"+l:l)+"."+r.getFullYear()}s.value=r}"function"==typeof t.props.onAfterClickDay&&t.props.onAfterClickDay(this,e)})}},{key:"initEvents",value:function(){this.props.buttons&&this.initButtonEvents(),this.initDayClickEvents()}},{key:"_generateHeader",value:function(){var t=this,e='\n      <table class="'+t.props.theme+'" cellpadding="0" cellspacing="0">\n        <tr>\n          <td colspan="7" class="'+(t.props.theme+t.default.header)+'">\n            ';return t.props.buttons&&(e+='<span id="'+t.props.prevButton+'" class="'+t.props.prevButton+'">'+this.props.prevButtonInnerHtml+"</span>"),e+='<span class="'+(t.props.theme+t.default.month)+'">'+t.getCurrentMonthName()+'</span>\n            <span class="'+(t.props.theme+t.default.year)+'">'+t.date.year+"</span>",t.props.buttons&&(e+='<span id="'+t.props.nextButton+'" class="'+t.props.nextButton+'">'+this.props.nextButtonInnerHtml+"</span>"),e+="\n          </td>\n        </tr>\n    "}},{key:"_animate",value:function(){for(var t=document.getElementsByClassName(this.props.theme+this.default.day),e=0;e<t.length;e++)t[e].style.opacity=1}},{key:"_generateHtml",value:function(){var t=this,e=t._generateHeader();e+='<tr class="'+(t.props.theme+t.default.week)+'">';var n=!0,a=!1,o=void 0;try{for(var r,s=t.props.weeks[Symbol.iterator]();!(n=(r=s.next()).done);n=!0){var i=r.value;e+='<td class="'+(t.props.theme+t.default.weekday)+'">'+i+"</td>"}}catch(t){a=!0,o=t}finally{try{!n&&s.return&&s.return()}finally{if(a)throw o}}e+="</tr>";for(var l=1,h=0;h<6&&!(l>=t.date.daysOfMonth);h++){e+='<tr class="'+(t.props.theme+t.default.days)+'">';for(var p=t.props.theme+t.default.day,u=0;u<7;u++)if(0==h&&u<this.date.startDay||l>t.date.daysOfMonth)e+="<td></td>";else{var d=new Date(t.date.year,t.date.month,l).getTime(),f=l+"."+t.date.month+"."+t.date.year==t.props.today?t.default.today:"";e+='\n              <td>\n                <a style="'+(t.props.fade?"opacity: 0; transition: opacity .4s;":"")+'" class="'+p+" "+(p+f)+'"\n                   data-time="'+d+'">\n                      '+l+"\n                </a>\n              </td>",l++}e+="</tr>"}e+="</tr>",e+="</table>",document.getElementById(t.props.parent).innerHTML=e,t.props.fade&&setTimeout(function(){t._animate()},50),t.initEvents()}}]),t}();